@using Microsoft.AspNetCore.Http
@using _10.Models

@{
    ViewData["Title"] = "Home Page";
    var sentPackages = ViewData["SentPackages"] as List<Package>;
    var receivedPackages = ViewData["ReceivedPackages"] as List<Package>;
}

<div class="text-center">
    <h1 class="display-4">
        @if (Context.Session.GetString("UserId") != null)
        {
            <span>Welcome, @Context.Session.GetString("Username")!</span>
        }
        else
        {
            <span>Home Page</span>
        }
    </h1>
</div>

@if (Context.Session.GetString("UserRole") == "User")
{
    <div class="row">
        <div class="col-md-6">
            <h2>Sent Packages</h2>
            @if (sentPackages != null && sentPackages.Any())
            {
                <table class="table">
                    <thead>
                        <tr>
                            <th>Tracking Number</th>
                            <th>Recipient</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var package in sentPackages)
                        {
                            <tr>
                                <td><a asp-controller="Package" asp-action="Details" asp-route-id="@package.PackageId">@package.TrackingNumber</a></td>
                                <td>@package.RecipientUser?.Username</td>
                                <td>@package.CurrentStatus?.Name</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <p>No packages sent.</p>
            }
        </div>
        <div class="col-md-6">
            <h2>Received Packages</h2>
            @if (receivedPackages != null && receivedPackages.Any())
            {
                <table class="table">
                    <thead>
                        <tr>
                            <th>Tracking Number</th>
                            <th>Sender</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var package in receivedPackages)
                        {
                            <tr>
                                <td><a asp-controller="Package" asp-action="Details" asp-route-id="@package.PackageId">@package.TrackingNumber</a></td>
                                <td>@package.SenderUser?.Username</td>
                                <td>@package.CurrentStatus?.Name</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <p>No packages received.</p>
            }
        </div>
    </div>
}
